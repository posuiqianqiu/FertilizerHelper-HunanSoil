<view class="container" wx:if="{{result}}">
  
  <!-- æ–¹æ¡ˆæ ‡é¢˜ -->
  <view class="result-header">
    <text class="result-title">ğŸŒ¾ æ¨èæ–½è‚¥æ–¹æ¡ˆ</text>
    <text class="result-subtitle">{{result.crop}} ({{result.targetYield}}kg/äº© Ã— {{result.area}}äº©)</text>
  </view>

  <!-- æ ¸å¿ƒæ–½è‚¥é‡è¡¨æ ¼ -->
  <view class="card">
    <view class="card-title">ğŸ“Š æ¨èæ–½è‚¥é‡</view>
    
    <view class="fertilizer-table">
      <view class="table-header">
        <text class="col-nutrient">å…»åˆ†ç±»å‹</text> 
        <text class="col-supplement">éœ€è¡¥é‡(kg/äº©)</text>
        <text class="col-fertilizer">æ¨èè‚¥æ–™(kg/äº©)</text>
        <text class="col-total">æ€»ç”¨é‡(kg)</text>
      </view>
      
      <view class="table-row">
        <text class="col-nutrient nutrient-n">æ°®(N)</text>
        <text class="col-supplement">{{result.supplements.N}}</text>
        <text class="col-fertilizer">å°¿ç´  {{result.fertilizers.urea.perMu}}</text>
        <text class="col-total">{{result.fertilizers.urea.total}}</text>
      </view>
      
      <view class="table-row">
        <text class="col-nutrient nutrient-p">ç£·(Pâ‚‚Oâ‚…)</text>
        <text class="col-supplement">{{result.supplements.P}}</text>
        <text class="col-fertilizer">è¿‡ç£·é…¸é’™ {{result.fertilizers.superphosphate.perMu}}</text>
        <text class="col-total">{{result.fertilizers.superphosphate.total}}</text>
      </view>
      
      <view class="table-row">
        <text class="col-nutrient nutrient-k">é’¾(Kâ‚‚O)</text>
        <text class="col-supplement">{{result.supplements.K}}</text>
        <text class="col-fertilizer">æ°¯åŒ–é’¾ {{result.fertilizers.potassiumChloride.perMu}}</text>
        <text class="col-total">{{result.fertilizers.potassiumChloride.total}}</text>
      </view>
    </view>
  </view>

  <!-- ç¼ºç´ è¯Šæ–­ -->
  <view class="card" wx:if="{{result.diagnosis.length > 0}}">
    <view class="card-title">ğŸ” åœŸå£¤è¯Šæ–­</view>
    <view class="diagnosis-list">
      <view 
        class="diagnosis-item {{item.indexOf('âš ï¸') > -1 ? 'warning' : 'success'}}"
        wx:for="{{result.diagnosis}}" 
        wx:key="index"
      >
        {{item}}
      </view>
    </view>
  </view>

  <!-- æ–½è‚¥å»ºè®® -->
  <view class="card">
    <view class="advice-header" bindtap="toggleAdvice">
      <text class="card-title">ğŸ’¡ æ–½è‚¥å»ºè®®</text>
      <text class="toggle-icon">{{showAdvice ? 'â–¼' : 'â–¶'}}</text>
    </view>
    
    <view class="advice-content" wx:if="{{showAdvice}}">
      <text class="advice-text">{{result.advice}}</text>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons">
    <button class="btn-secondary" bindtap="recalculate">
      é‡æ–°è®¡ç®—
    </button>
    <button class="btn-primary" bindtap="copyResult">
      å¤åˆ¶æ–¹æ¡ˆ
    </button>
  </view>

  <!-- å…è´£å£°æ˜ -->
  <view class="disclaimer">
    <text class="disclaimer-text">
      âš ï¸ æ¨èæ–¹æ¡ˆä»…ä¾›å‚è€ƒï¼Œè¯·ç»“åˆç”°é—´å®é™…æƒ…å†µè°ƒæ•´ã€‚å»ºè®®å’¨è¯¢å½“åœ°å†œæŠ€ä¸“å®¶è·å¾—æ›´ç²¾å‡†çš„æŒ‡å¯¼ã€‚
    </text>
  </view>

</view>

<!-- åŠ è½½å¤±è´¥æç¤º -->
<view class="error-container" wx:else>
  <text class="error-text">æ•°æ®åŠ è½½å¤±è´¥ï¼Œè¯·è¿”å›é‡è¯•</text>
  <button class="btn-primary" bindtap="recalculate">è¿”å›é¦–é¡µ</button>
</view>